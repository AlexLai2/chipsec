<?xml version="1.0"?>
<configuration platform="KNL" >
<!-- XML configuration file for Knights Landing Server
-->
<!--
# *********************************************************
#
#                   PRE-RELEASE NOTICE
#
#    This software specifically enables pre-production
#    hardware provided by Intel Corporation.  The terms
#    describing your rights and responsibilities to use
#    such hardware are covered by a separate evaluation
#    agreement.  Of specific note in that agreement is
#    the requirement that you do not release or publish
#    information on the hardware without the specific
#    written authorization of Intel Corporation.
#
#    Intel Corporation requests that you do not release,
#    publish, or distribute this software until you are
#    specifically authorized.  These terms are deleted
#    upon publication of this software.
#
# *********************************************************

CHIPSEC: Platform Security Assessment Framework
Copyright (c) 2018-2020, Intel Corporation

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; Version 2.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Contact information:
chipsec@intel.com
-->

  <!-- #################################### -->
  <!--                                      -->
  <!-- Information                          -->
  <!--                                      -->
  <!-- #################################### -->
  <info family="xeon">
    <sku did="0x7801" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7802" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7803" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7804" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7805" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7806" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7818" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x7819" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
    <sku did="0x783D" name="Knights Landing Server" code="KNL" longname="Intel Xeon Phi Processor (Knights Landing Server CPU / Wellsburg PCH)" />
  </info>

  <pci>
  </pci>

  <mmio>
    <bar name="MMCFG"  bus="0" dev="5"    fun="0" reg="0x90" width="8" mask="0x7FFFFFC000000" size="0x1000" desc="PCI Express Register Range"/>
    <bar name="DMIBAR" bus="0" dev="0"    fun="0" reg="0x50" width="4" mask="0xFFFFF000"      size="0x1000" enable_bit="0" desc="Root Complex Register Range"/>
  </mmio>

  <io>
  </io>

  <memory>
  </memory>

  <registers>
    <!-- Host Controller -->
    <register name="DMIRCBAR" type="pcicfg" bus="0" dev="0" fun="0" offset="0x50" size="4" desc="DMI Root Complex Register Block Base Address">
      <field name="dmircbaren" bit="0"  size="1"  desc="Enable DMIRCBAR"/>
      <field name="dmircbar"   bit="12" size="20" desc="Base address DMI Root Complex register space"/>
    </register>

    <register name="TSEG" type="pcicfg" bus="0" dev="5" fun="0" offset="0xA8" size="8" desc="TSEG Memory">
      <field name="base"  bit="20" size="12" desc="Base address"/>
      <field name="limit" bit="52" size="12" desc="Limit address"/>
    </register>
    <register name="TSEG_BASE" type="pcicfg" bus="0" dev="5" fun="0" offset="0xA8" size="8" desc="TSEG Memory Base">
      <field name="base"  bit="20" size="12" desc="Base address"/>
      <field name="limit" bit="52" size="12" desc="Limit address"/>
    </register>
    <register name="TSEG_LIMIT" type="pcicfg" bus="0" dev="5" fun="0" offset="0xA8" size="8" desc="TSEG Memory Limit">
      <field name="base"  bit="20" size="12" desc="Base address"/>
      <field name="limit" bit="52" size="12" desc="Limit address"/>
    </register>
    <register name="VTBAR" type="mmcfg" bus="0" dev="5" fun="0" offset="0x180" size="4" desc="VT BAR Register">
      <field name="Enable" bit="0"  size="1"  desc="VTBAR enable"/>
      <field name="Base"   bit="13" size="19" desc="VTD Base Address"/>
    </register>
    <register name="VTGENCTRL" type="mmcfg" bus="0" dev="5" fun="0" offset="0x184" size="4" desc="VTGENCTRL Register">
      <field name="gpa_limit" bit="0"  size="4" desc="Guest virtual addressing limit"/>
      <field name="hpa_limit" bit="4"  size="4" desc="Host processor addressing limit"/>
      <field name="lockvtd"   bit="15" size="1" desc="lockvtd"/>
    </register>
    <register name="LTDPR" type="mmcfg" bus="0" dev="5" fun="0" offset="0x290" size="4" desc="Intel TXT DMA Protected Range Register">
      <field name="lock"       bit="0"  size="1"  desc="Lock LTDPR register"/>
      <field name="protregsts" bit="1"  size="1"  desc="Protection enabled in HW"/>
      <field name="commandbit" bit="2"  size="1"  desc="Command bit"/>
      <field name="size"       bit="4"  size="8"  desc="Size of memory"/>
      <field name="topofdpr"   bit="20" size="12" desc="Top address +1 of DPR"/>
    </register>
    

    <!-- GENPROTRANGE Registers -->
    <register name="GENPROTRANGE1_BASE" type="pcicfg" bus="0" dev="5" fun="0" offset="0xB0" size="8" desc="Generic Protected Memory Range 1 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 1 base address"/>
    </register>
    <register name="GENPROTRANGE1_LIMIT" type="pcicfg" bus="0" dev="5" fun="0" offset="0xB8" size="8" desc="Generic Protected Memory Range 1 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 1 limit address"/>
    </register>
    <register name="GENPROTRANGE2_BASE" type="pcicfg" bus="0" dev="5" fun="0" offset="0xC0" size="8" desc="Generic Protected Memory Range 2 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 2 base address"/>
    </register>
    <register name="GENPROTRANGE2_LIMIT" type="pcicfg" bus="0" dev="5" fun="0" offset="0xC8" size="8" desc="Generic Protected Memory Range 2 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 2 limit address"/>
    </register>
    <register name="GENPROTRANGE0_BASE" type="mmcfg" bus="0" dev="5" fun="0" offset="0x120" size="8" desc="Generic Protected Memory Range 0 Base Address">
      <field name="base_address" bit="16" size="35" desc="GENPROTRANGE 0 base address"/>
    </register>
    <register name="GENPROTRANGE0_LIMIT" type="mmcfg" bus="0" dev="5" fun="0" offset="0x128" size="8" desc="Generic Protected Memory Range 0 Limit Address">
      <field name="limit_address" bit="16" size="35" desc="GENPROTRANGE 0 limit address"/>
    </register>
    
    <!-- PCH ABASE (PMBASE) I/O registers -->
    <register name="SMI_EN" type="iobar" bar="ABASE" offset="0x30" size="4" desc="SMI Control and Enable">
      <field name="GBL_SMI_EN"         bit="0"  size="1"/>
      <field name="EOS"                bit="1"  size="1"/>
      <field name="BIOS_EN"            bit="2"  size="1"/>
      <field name="LEGACY_USB_EN"      bit="3"  size="1"/>
      <field name="SLP_SMI_EN"         bit="4"  size="1"/>
      <field name="APMC_EN"            bit="5"  size="1"/>
      <field name="SWSMI_TMR_EN"       bit="6"  size="1"/>
      <field name="BIOS_RLS"           bit="7"  size="1"/>
      <field name="MCSMI_EN"           bit="11" size="1"/>
      <field name="TCO_EN"             bit="13" size="1"/>
      <field name="PERIODIC_EN"        bit="14" size="1"/>
      <field name="LEGACY_USB2_EN"     bit="17" size="1"/>
      <field name="INTEL_USB2_EN"      bit="18" size="1"/>
      <field name="GPIO_UNLOCK_SMI_EN" bit="27" size="1"/>
      <field name="ME _SMI_EN"         bit="30" size="1"/>
      <field name="xHCI _SMI_EN"       bit="31" size="1"/>
    </register>

  </registers>

</configuration>
