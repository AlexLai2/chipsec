<?xml version="1.0"?>
<configuration>
<!-- Common xml configuration file
-->
<!--
# *********************************************************
#
#                   PRE-RELEASE NOTICE
#
#    This software specifically enables pre-production
#    hardware provided by Intel Corporation.  The terms
#    describing your rights and responsibilities to use
#    such hardware are covered by a separate evaluation
#    agreement.  Of specific note in that agreement is
#    the requirement that you do not release or publish
#    information on the hardware without the specific
#    written authorization of Intel Corporation.
#
#    Intel Corporation requests that you do not release,
#    publish, or distribute this software until you are
#    specifically authorized.  These terms are deleted
#    upon publication of this software.
#
# *********************************************************

CHIPSEC: Platform Security Assessment Framework
Copyright (c) 2017-2020, Intel Corporation

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; Version 2.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Contact information:
chipsec@intel.com
-->

  <!-- #################################### -->
  <!--                                      -->
  <!-- Configuration registers              -->
  <!--                                      -->
  <!-- #################################### -->
  <registers>

    <!-- BIOS Guard specific MSRs -->
    <register name="MSR_PLATFORM_INFO" type="msr" msr="0xCE" desc="Platform Info MSR">
      <field name="BIOSGuard" bit="35" size="1" desc="BIOS Guard" />
      <field name="SAMPLE_PART" bit="27" size="1" desc="preproduction sample" />
    </register>
    <register name="PLAT_FRMW_PROT_CTRL_MSR" type="msr" msr="0x110" desc="Platform Firmware Protection Control MSR">
      <field name="Lock"   bit="0" size="1" desc="BIOS Guard Lock" />
      <field name="Enable" bit="1" size="1" desc="BIOS Guard Enable" />
    </register>

    <!-- CPU Model Specific Registers -->
    <register name="FEATURE_CONFIG"   type="msr" msr="0x13C" desc="FEATURE_CONFIG Register">
      <field name="Lock"     bit="0"  size="1"  desc="FEATURE_CONFIG Register Lock" />
    </register>

    <register name="PM_CFG" type="mmio" bar="RCBA" offset="0x3318" size="4" desc="PMC Configuration">
      <field name="BIT27" bit="27" size="1" desc="BIT 27"/>
    </register>

    <register name="LT_LOCK_MEMORY" type="msr" msr="0x2E7" desc="Config Lock MSR">
      <field name="ConfigLock" bit="0" size="1" desc="ConfigLock"/>
    </register>
  </registers>

  <controls>
    <control name="PlatformSamplePart" register="MSR_PLATFORM_INFO"   field="SAMPLE_PART" desc="preproduction sample"/>
    <control name="FeatureConfigLock" register="FEATURE_CONFIG" field="Lock" desc="Lock CPU feature config"/>
    <control name="SPIFDSecurityOverridePinStrap" register="HSFS" field="FDOPSS" desc="SPI Controller Flash Descriptor Security Override Pin Strap (FDOPSS)"/>
    <control name="ConfigLock" register="LT_LOCK_MEMORY" field="ConfigLock" desc="Configuration Lock"/>
  </controls>

</configuration>