<?xml version="1.0"?>
<configuration platform="GLK">
<!-- XML configuration for GLK
-->
<!--
# *********************************************************
#
#                   PRE-RELEASE NOTICE
#
#    This software specifically enables pre-production
#    hardware provided by Intel Corporation.  The terms
#    describing your rights and responsibilities to use
#    such hardware are covered by a separate evaluation
#    agreement.  Of specific note in that agreement is
#    the requirement that you do not release or publish
#    information on the hardware without the specific
#    written authorization of Intel Corporation.
#
#    Intel Corporation requests that you do not release,
#    publish, or distribute this software until you are
#    specifically authorized.  These terms are deleted
#    upon publication of this software.
#
# *********************************************************

CHIPSEC: Platform Security Assessment Framework
Copyright (c) 2017-2020, Intel Corporation

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; Version 2.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Contact information:
chipsec@intel.com
-->
  <!-- #################################### -->
  <!--                                      -->
  <!-- Configuration registers              -->
  <!--                                      -->
  <!-- #################################### -->

  <registers>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- PCI CFG registers            -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <register name="PCI0.0.0_GGC" type="pcicfg" bus="0" dev="0" fun="0" offset="0x50" size="2" desc="Graphics Control">
        <field name="GMS"     bit="8" size="8" desc="GMS" />
        <field name="GGMS"    bit="6" size="2" desc="GGMS" />
        <field name="VAMEN"   bit="2" size="1" desc="VAMEN" />
        <field name="IVD"     bit="1" size="1" desc="IVD" />
        <field name="GGCLOCK" bit="0" size="1" desc="GGC Lock"/>
    </register>
    <register name="PCI0.0.0_PAVPC" type="pcicfg" bus="0" dev="0" fun="0" offset="0x58" size="4" desc="PAVP Control">
        <field name="PCMBASE" bit="20" size="12" desc="PCMBASE" />
        <field name="WOPCM" bit="7" size="2" desc="WOPCM Size" />
        <field name="ASMFEN" bit="6" size="1" desc="ASMF Method Enable" />
        <field name="OVTATTACK" bit="4" size="1" desc="Override Unsolicited Connection State Attack and Terminate" />
        <field name="PAVPLCK" bit="2" size="1" desc="PAVP Lock" />
        <field name="PAVPE" bit="1" size="1" desc="PAVP Enable" />
        <field name="PCME" bit="0" size="1" desc="PCM Enable" />
    </register>
    <register name="PCI0.0.0_DPR" type="pcicfg" bus="0" dev="0" fun="0" offset="0x5C" size="4" desc="DMA Protected Region">
        <field name="TOPOFDPR" bit="20" size="12" desc="Top of DPR" />
        <field name="DPRSIZE" bit="4" size="8" desc="DPR Size" />
        <field name="EPM" bit="2" size="1" desc="DPR Enable" />
        <field name="PRS" bit="1" size="1" desc="DPR Status" />
        <field name="LOCK" bit="0" size="1" desc="DPR Lock" />
    </register>
    <register name="PCI0.0.0_BDSM" type="pcicfg" bus="0" dev="0" fun="0" offset="0xB0" size="4" desc="Base of Graphics Stolen Memory">
        <field name="BDSM" bit="20" size="12" desc="DSM Base" />
        <field name="LOCK" bit="0"  size="1"  desc="Lock" />
    </register>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- MMIO registers               -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <register name="IGD_CONFIG_0" type="mmio" bar="GTTMMADR" offset="0x0D00" size="4" desc="Config Register for RPM Unit">
        <field name="DISABLE_TSC_SYNC" bit="0" size="1" desc="TSC synchronization disable" />
        <field name="ICB" bit="1" size="3" desc="Workaround enable bits" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_BASE_0" type="mmio" bar="GTTMMADR" offset="0x4150" size="4" desc="Config Access Range Register 0 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_0" type="mmio" bar="GTTMMADR" offset="0x4154" size="4" desc="Config Access Range Register 0 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_1" type="mmio" bar="GTTMMADR" offset="0x4158" size="4" desc="Config Access Range Register 1 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_1" type="mmio" bar="GTTMMADR" offset="0x415C" size="4" desc="Config Access Range Register 1 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_2" type="mmio" bar="GTTMMADR" offset="0x4160" size="4" desc="Config Access Range Register 2 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_2" type="mmio" bar="GTTMMADR" offset="0x4164" size="4" desc="Config Access Range Register 2 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_3" type="mmio" bar="GTTMMADR" offset="0x4168" size="4" desc="Config Access Range Register 3 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_3" type="mmio" bar="GTTMMADR" offset="0x416C" size="4" desc="Config Access Range Register 3 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_4" type="mmio" bar="GTTMMADR" offset="0x4170" size="4" desc="Config Access Range Register 4 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_4" type="mmio" bar="GTTMMADR" offset="0x4174" size="4" desc="Config Access Range Register 4 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_5" type="mmio" bar="GTTMMADR" offset="0x4178" size="4" desc="Config Access Range Register 5 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_5" type="mmio" bar="GTTMMADR" offset="0x417C" size="4" desc="Config Access Range Register 5 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_6" type="mmio" bar="GTTMMADR" offset="0x4180" size="4" desc="Config Access Range Register 6 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_6" type="mmio" bar="GTTMMADR" offset="0x4184" size="4" desc="Config Access Range Register 6 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="IGD_CARR_BASE_7" type="mmio" bar="GTTMMADR" offset="0x4188" size="4" desc="Config Access Range Register 7 Base">
        <field name="VALID" bit="0" size="1" desc="Register valid" />
        <field name="ACCESS" bit="1" size="1" desc="Access permissions" />
        <field name="BASE" bit="2" size="20" desc="Base address" />
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
    </register>
    <register name="IGD_CARR_LIMIT_7" type="mmio" bar="GTTMMADR" offset="0x418C" size="4" desc="Config Access Range Register 7 Limit">
        <field name="LOCK" bit="31" size="1" desc="Register lock" />
        <field name="LIMIT" bit="0" size="22" desc="Range limit" />
    </register>
    <register name="GT_FORCE_WAKE" type="mmio" bar="GTTMMADR" offset="0xA188" size="4" desc="GT Force Wake register">
        <field name="WAKE_MASK" bit="16" size="16" desc="GT thread wake mask" />
        <field name="WAKE_REQUEST" bit="0" size="16" desc="GT thread wake request" />
    </register>
    <register name="GTSP1" type="mmio" bar="GTTMMADR" offset="0x130044" size="4" desc="GT scratch pad 1">
        <field name="WAKE_REQUEST" bit="0" size="16" desc="GT thread wake request status" />
    </register>

    <register name="HSFS" type="mmio" bar="SPIBAR" offset="0x4" size="4" desc="HW sequencing flash status">
      <field name="FDONE"   bit="0"  size="1" desc="Flash Cycle Done"/>
      <field name="FCERR"   bit="1"  size="1" desc="Flash Cycle Error"/>
      <field name="AEL"     bit="2"  size="1" desc="Access Error Log"/>
      <field name="SCIP"    bit="5"  size="1" desc="SPI cycle in progress"/>
      <field name="WRSDIS"  bit="11" size="1" desc="Write status disable"/>
      <field name="PR34LKD" bit="12" size="1" desc="PRR3 PRR4 Lock-Down"/>
      <field name="FDOPSS"  bit="13" size="1" desc="Flash Descriptor Override Pin-Strap Status"/>
      <field name="FDV"     bit="14" size="1" desc="Flash Descriptor Valid"/>
      <field name="FLOCKDN" bit="15" size="1" desc="Flash Configuration Lock-Down"/>
      <field name="FGO"     bit="16" size="1" desc="Flash cycle go"/>
      <field name="FCYCLE"  bit="17" size="4" desc="Flash Cycle Type"/>
      <field name="WET"     bit="21" size="1" desc="Write Enable Type"/>
      <field name="FDBC"    bit="24" size="6" desc="Flash Data Byte Count"/>
      <field name="FSMIE"   bit="31" size="1" desc="Flash SPI SMI Enable"/>
    </register>

	<!-- DCI registers -->

    <register name="ECTRL" type="mm_msgbus" port="0xA8" offset="0x04" size="4" desc="DCI Control Register">
      <field name="LOCK" bit="0" size="1"/>
	    <field name="ENABLE" bit="4" size="1"/>
      <field name="AVAILABLE" bit="8" size="1"/>
    </register>

    <!-- GFx MMIO registers -->
    <register name="PCBR" type="mmio" bar="GTTMMADR" offset="0x182120" desc="PCBR">
        <field name="PCBR_LOCK" bit="0" size="1"/>
    </register>

    <!-- CPU Model Specific Registers (MSR) -->
    <register name="IA32_BIOS_SIGN_ID"    type="msr" msr="0x8B" desc="Microcode Update Signature Register">
      <field name="Microcode" bit="63" size="32" desc="Microcode update signature" />
    </register>

    <register name="MSR_POWER_MISC" type="msr" msr="0x120" desc="MISC" />

    <register name="LOCK" type="mmio" bar="PWRMBASE" offset="0x10CC" size="4" desc="General PM Configuration B">
      <field name="ESPI_SMI"        bit="13"  size="1" desc="Lock bit ACPI.SMI_EN" />
      <field name="OBFF"            bit="12"  size="1" desc="Lock OBFF" />
      <field name="PWRBTN"          bit="11"  size="1" desc="Lock PMC_CFG2.pwrbtn_dis" />
      <field name="LPC_LPB"         bit="10"  size="1" desc="Lock GEN_PMCON2.lpc_lpb_clk_ctrl" />
      <field name="SLPSX"           bit="9"   size="1" desc="ASLP Sx# Stretching Policy Lock-Down (GEN_PMCON3 PM_CFG)" />
      <field name="IRQ_SEL"         bit="8"   size="1" desc="Lock IRQ_SEL_0 IRQ_SEL_1 IRQ_SEL_2" />
      <field name="CRID"            bit="7"   size="1" desc="Lock CRID" />
      <field name="SX_WAKE"         bit="6"   size="1" desc="Lock GEN_PMCON1 pme_b0_s5_dis and ag3e" />
      <field name="RSVD_PCIE"       bit="5"   size="1" desc="Lock GEN_PMCON2 bios_pci_exp_en" />
      <field name="PER_SMI"         bit="4"   size="1" desc="Lock GEN_PMCON2 per_smi_sel" />
      <field name="FUNC_DIS"        bit="3"   size="1" desc="Lock FUNC_DIS_0 FUNC_DIS_1" />
      <field name="RSVD_S0IX"       bit="2"   size="1" desc="Lock S0IX_WAKE_EN and ETR MAX_S0IX" />
      <field name="IRQ_CFG_UART"    bit="1"   size="1" desc="Lock IRQ_CFG_UART" />
    </register>

    <register name="ETR3" type="mmio" bar="PWRMBASE" offset="0x1048" size="4" desc="Extended Test Mode Register">
        <field name="CF9LOCK" bit="31"  size="1"  desc="CF9h Lockdown"/>
    </register>

    <!-- Undefined Registers -->
    <register name="PLAT_FRMW_PROT_CTRL_MSR" undef="Not defined for platform" />

  </registers>

  <!-- #################################### -->
  <!--                                      -->
  <!-- 'Controls'                           -->
  <!--                                      -->
  <!-- #################################### -->
  <controls>
    <control name="SpiWriteStatusDis"      register="HSFS"  field="WRSDIS"  desc="Write Status Disable"/>
  </controls>
</configuration>